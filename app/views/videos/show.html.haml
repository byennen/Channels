- title @channel.name + " - " + @video.title

- content_for :open_graph do
  %meta{property: "og:title", content: @video.title}
  %meta{property: "og:type", content: "video.other"}
  %meta{property: "og:url",  content: video_url(@video)}
  %meta{property: "og:image",content: @video.image.url(:host => "http://#{request.host}")}
  %meta{property: "og:site_name", content: "Altimarc"}
  %meta{property: "og:description", content: @video.description}

.row-fluid
  .span
    .videoplayer
      .projekktor_background
        #video
        #player
          .projekktor
      #video_info{:style => 'max-width: 940px; margin: 0 auto;'}
        .row-fluid#video_info_inside
          .span12
            .row-fluid
              .span8
                %h2
                  = link_to @channel.name, channel_url(@channel)
                  %span - 
                  = @video.title
                %ul#video_social_sharing
                  -#%li= link_to "Facebook", "#"
                  -#%li= link_to "Tweet", "#"
                  -#TODO: Add share by email function 
                  -#%li= link_to "Share", "#"
                  %li= link_to "Details", "#", :id => "details_link", :class => 'disable-pjax'
              .span4.pull-right
                #small_ad.pull-right
                  = image_tag('ads/sample-ad.png')
        #details.row
          .span
            %p= @video.description
    

.row-fluid
  .span8
    %h2.heading All Webisodes
    #all_videos.carousel.slide
    - @videos.each_slice(4) do |videos|
      .item{class: carousel_class(@videos, videos)}
        %ul.thumbnails
          - videos.each do |video|
            %li.span3
              .thumbnail
                %img{:alt => "", :src => video.image.thumb('260x180').url}
                  .caption
                    %h5= video.title
                    %p= video.description
                    %p
                      - if video.publish_on < Time.now
                        - if user_signed_in? && current_user.paid_member?
                          = link_with_icon("Watch", video_path(video), "icon-film icon-white", "connected btn btn-success")
                        - else
                          = link_with_icon("Free Trailer", video_path(video), "icon-film icon-white", "connected btn btn-success")
                      - else
                        = link_with_icon("Coming Soon", "#", "icon-film icon-white", "btn btn-inverse")


  .span4
    .rightsidebar
      .row-fluid
        .span
          %h1.heading= @channel.name
          #description.span
            %p= @channel.description
          = render 'channels/social_media'
        .row-fluid
          .span
            %h2.heading Featured Album
            = render 'channels/featured_album'
        .row-fluid
          .span
            %h2.heading Featured Sponsor
            .thumbnail
              = link_to image_tag('layout/ad-holder.png'), altimarc_for_your_business_url


:javascript
  $(document).ready(function() {
    function set_ads() {
      $('#small_ad').show();
      $('#small_ad').click(function() {
          window.open('http://altimarc.com/altimarc-for-your-business', '_blank');
      })
    }

    function unset_ads() {
      $('#small_ad').hide();
    }

    function unpaid_members() {
      $('#unpaid_members_videos_modal').modal('show');
    }

    var player = projekktor('.projekktor', {
      poster: "#{@video.image.url}",
      controls: true,
      plugin_display: {
        logoImage:"../../../../assets/html5video/logo.png",
        logoPosition:"tr"
      },
      playlist: [
        {
          0: {src:'../../../../assets/html5video/ad-placeholder.png', type:"image/jpeg"},
          config:{
            duration: 5,
            title: 'advertisement',
            lassName: 'ad',
            controls: false,
            disallowSkip: true,
            plugin_controlbar: {
              showOnStart: true,
              disableFade: true
          },
          plugin_display: {
            staticControls: false,
              displayPlayingClick: function() {
                window.open('http://altimarc.com/altimarc-for-your-business', '_blank');
              }
            }
          }
        },
        {
          #{raw video_playlist(@video) }
          ,
          config: {
            title: "#{@video.title}",
            className: 'postad',
            disallowSkip: true
          }
        },
        {
          0: {src:'../../../../assets/html5video/ad-placeholder.png', type:"image/png"},
          config:{
            duration: 5,
            title: 'advertisement',
            lassName: 'ad',
            controls: false,
            disallowSkip: true,
            plugin_controlbar: {
              showOnStart: true,
              disableFade: true
            },
            plugin_display: {
              staticControls: false,
                displayPlayingClick: function() {
                  window.open('http://altimarc.com/altimarc-for-your-business', '_blank');
                }
            }
          }
        }
        #{raw include_next_episode_preview(current_user, @next_video)}
      ]
    }, function(player) {
      player.addListener('start', set_ads)
      player.addListener('done', unpaid_members)
      player.addListener('done', unset_ads)
    });
  });
